{"ast":null,"code":"var _jsxFileName = \"G:\\\\Simple React MS-7\\\\ema-jhon\\\\src\\\\component\\\\Login\\\\Login.js\",\n    _s = $RefreshSig$();\n\n//in this project need for facebook sign in method by firebase.\nimport firebase from \"firebase/app\";\nimport \"firebase/auth\";\nimport firebaseConfig from './firebase.config';\nimport { useContext, useState } from 'react';\nimport { UserContext } from \"../../App\";\nimport { useHistory } from \"react-router-dom\";\nimport { useLocation } from 'react-router-dom';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfirebase.initializeApp(firebaseConfig);\n\nfunction Login() {\n  _s();\n\n  const [newUser, setNewUser] = useState(false);\n  document.title = \"Manage Inventory\";\n  const [user, setUser] = useState({\n    isSignedIn: false,\n    newUser: false,\n    name: '',\n    email: '',\n    password: '',\n    photo: '',\n    error: '',\n    success: false\n  });\n  const [loggedInUser, setLoggedInUser] = useContext(UserContext);\n  const history = useHistory();\n  const location = useLocation();\n  let {\n    from\n  } = location.state || {\n    from: {\n      pathname: \"/\"\n    }\n  };\n  const provider = new firebase.auth.GoogleAuthProvider();\n  const fbProvider = new firebase.auth.FacebookAuthProvider();\n\n  const handleSignIn = () => {\n    firebase.auth().signInWithPopup(provider).then(res => {\n      const {\n        displayName,\n        photoURL,\n        email\n      } = res.user;\n      const signedInUser = {\n        isSignedIn: true,\n        name: displayName,\n        email: email,\n        photo: photoURL,\n        success: true\n      };\n      setUser(signedInUser);\n    }).catch(err => {\n      console.log(err);\n      console.log(err.message);\n    });\n  };\n\n  const setUserToken = () => {\n    firebase.auth().currentUser.getIdToken(true).then(function (idToken) {\n      sessionStorage.setItem('token', idToken);\n    }).catch(function (error) {// Handle error\n    });\n  };\n\n  const handlefbSignIn = () => {\n    firebase.auth().signInWithPopup(fbProvider).then(result => {\n      /** @type {firebase.auth.OAuthCredential} */\n      var credential = result.credential;\n      var user = result.user;\n      console.log('fb user after sign in', user);\n      var accessToken = credential.accessToken; // ...\n    }).catch(error => {\n      var errorCode = error.code;\n      var errorMessage = error.message;\n      var email = error.email;\n      var credential = error.credential; // ...\n    });\n  };\n\n  const handleSignOut = () => {\n    firebase.auth().signOut().then(res => {\n      const signedOutUser = {\n        isSignedIn: false,\n        name: \"\",\n        photo: \"\",\n        email: \"\"\n      };\n      setUser(signedOutUser);\n    }).catch(err => {});\n  };\n\n  const handleChange = e => {\n    let isFormValid = true;\n\n    if (e.target.name === 'email') {\n      isFormValid = /\\S+@\\S+\\.\\S+/.test(e.target.value);\n    }\n\n    if (e.target.name === 'password') {\n      const isPasswordValid = e.target.value.length > 6;\n      const passwordHasNumber = /\\d{1}/.test(e.target.value);\n      isFormValid = isPasswordValid && passwordHasNumber;\n    }\n\n    if (isFormValid) {\n      const newUserInfo = { ...user\n      };\n      newUserInfo[e.target.name] = e.target.value;\n      setUser(newUserInfo);\n    }\n  };\n\n  const handleSubmit = e => {\n    if (newUser && user.email && user.password) {\n      firebase.auth().createUserWithEmailAndPassword(user.email, user.password).then(res => {\n        const newUserInfo = { ...user\n        };\n        newUserInfo.error = '';\n        newUserInfo.success = true;\n        setUser(newUserInfo);\n        updateUserName(user.name); // ...\n      }).catch(error => {\n        const newUserInfo = { ...user\n        };\n        newUserInfo.error = error.message;\n        newUserInfo.success = false;\n        setUser(newUserInfo); // ..\n      });\n    }\n\n    if (!newUser && user.email && user.password) {\n      firebase.auth().signInWithEmailAndPassword(user.email, user.password).then(res => {\n        const newUserInfo = { ...user\n        };\n        newUserInfo.error = '';\n        newUserInfo.success = true;\n        setUser(newUserInfo);\n        setLoggedInUser(newUserInfo);\n        history.replace(from);\n        console.log(\"sign in info\", user.res); // ...\n      }).catch(function (error) {\n        const newUserInfo = { ...user\n        };\n        newUserInfo.error = error.message;\n        newUserInfo.success = false;\n        setUser(newUserInfo);\n      });\n    }\n\n    e.preventDefault();\n  };\n\n  const updateUserName = name => {\n    const user = firebase.auth().currentUser;\n    user.updateProfile({\n      displayName: name\n    }).then(() => {\n      // Update successful\n      console.log('update user name successfully');\n    }).catch(error => {\n      // An error occurred\n      console.log(error);\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"App\",\n    children: [user.isSignedIn ? /*#__PURE__*/_jsxDEV(\"button\", {\n      onBlur: handleSignOut,\n      children: \"Sign out\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 23\n    }, this) : /*#__PURE__*/_jsxDEV(\"button\", {\n      onBlur: handleSignIn,\n      children: \"Sign in\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 183,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: handlefbSignIn,\n      children: \" Sign in using Facebook\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 5\n    }, this), user.isSignedIn && /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"Welcome, \", user.name]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 187,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"Your email: \", user.email]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 188,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n        src: user.photo,\n        alt: \"\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 189,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 26\n    }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \" Our own authentication\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"checkbox\",\n      onChange: () => setNewUser(!newUser),\n      name: \"newUser\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n      htmlFor: \"newUser\",\n      children: \"New user sign up\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      style: {\n        color: 'red'\n      },\n      children: [\" \", user.error]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 5\n    }, this), user.success && /*#__PURE__*/_jsxDEV(\"p\", {\n      style: {\n        color: 'green'\n      },\n      children: [\" user \", newUser ? 'created' : 'Logged In', \" successfully\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 22\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      action: \"\",\n      onSubmit: handleSubmit,\n      children: [newUser && /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        onBlur: handleChange,\n        name: \"name\",\n        placeholder: \"Write your name\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 201,\n        columnNumber: 19\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 202,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        onBlur: handleChange,\n        name: \"email\",\n        placeholder: \"Write your email\",\n        required: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 203,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 204,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"password\",\n        onBlur: handleChange,\n        name: \"password\",\n        placeholder: \"Password\",\n        required: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 205,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 206,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"submit\",\n        value: newUser ? 'Sign up' : 'Sign In'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 207,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 199,\n      columnNumber: 5\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 177,\n    columnNumber: 5\n  }, this);\n}\n\n_s(Login, \"zotxa3HJxawb7v82S2W/1z8oSqg=\", false, function () {\n  return [useHistory, useLocation];\n});\n\n_c = Login;\nexport default Login;\n\nvar _c;\n\n$RefreshReg$(_c, \"Login\");","map":{"version":3,"sources":["G:/Simple React MS-7/ema-jhon/src/component/Login/Login.js"],"names":["firebase","firebaseConfig","useContext","useState","UserContext","useHistory","useLocation","initializeApp","Login","newUser","setNewUser","document","title","user","setUser","isSignedIn","name","email","password","photo","error","success","loggedInUser","setLoggedInUser","history","location","from","state","pathname","provider","auth","GoogleAuthProvider","fbProvider","FacebookAuthProvider","handleSignIn","signInWithPopup","then","res","displayName","photoURL","signedInUser","catch","err","console","log","message","setUserToken","currentUser","getIdToken","idToken","sessionStorage","setItem","handlefbSignIn","result","credential","accessToken","errorCode","code","errorMessage","handleSignOut","signOut","signedOutUser","handleChange","e","isFormValid","target","test","value","isPasswordValid","length","passwordHasNumber","newUserInfo","handleSubmit","createUserWithEmailAndPassword","updateUserName","signInWithEmailAndPassword","replace","preventDefault","updateProfile","color"],"mappings":"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","sourcesContent":["//in this project need for facebook sign in method by firebase.\r\n\r\n\r\nimport firebase from \"firebase/app\";\r\nimport \"firebase/auth\";\r\nimport firebaseConfig from './firebase.config';\r\nimport { useContext, useState } from 'react';\r\nimport { UserContext } from \"../../App\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport { useLocation } from 'react-router-dom';\r\n\r\nfirebase.initializeApp(firebaseConfig);\r\nfunction Login() {\r\n\r\n  const [newUser, setNewUser]=useState(false);\r\n  document.title = \"Manage Inventory\";\r\nconst [user, setUser]=useState({\r\n  isSignedIn: false,\r\n  newUser: false,\r\n  name: '',\r\n  email:'',\r\n  password: '',\r\n  photo:'',\r\n  error:'',\r\n  success:false,\r\n})\r\n\r\nconst [loggedInUser, setLoggedInUser] = useContext(UserContext);\r\nconst history = useHistory();\r\n    const location = useLocation();\r\n\r\n    let { from } = location.state || { from: { pathname: \"/\" } };\r\n  const provider = new firebase.auth.GoogleAuthProvider();\r\n  const fbProvider = new firebase.auth.FacebookAuthProvider();\r\n  const handleSignIn=()=>{\r\n    firebase.auth().signInWithPopup(provider)\r\n    .then(res=>{\r\n      const {displayName, photoURL, email}=res.user;\r\n      const signedInUser={\r\n        isSignedIn:true,\r\n        name: displayName,\r\n        email:email,\r\n        photo: photoURL,\r\n        success:true\r\n      }\r\n      setUser(signedInUser);\r\n      \r\n    })\r\n    .catch(err=>{\r\n      console.log(err);\r\n      console.log(err.message);\r\n    })\r\n    \r\n  }\r\n  const setUserToken = () => {\r\n    firebase.auth().currentUser.getIdToken( true).then(function(idToken) {\r\n  sessionStorage.setItem('token', idToken)      \r\n    }).catch(function(error) {\r\n      // Handle error\r\n    });\r\n    \r\n  }\r\n  const handlefbSignIn= ()=> {\r\n    firebase.auth()\r\n  .signInWithPopup(fbProvider)\r\n  .then((result) => {\r\n    /** @type {firebase.auth.OAuthCredential} */\r\n    var credential = result.credential;\r\n    var user = result.user;\r\n    console.log('fb user after sign in',user);\r\n    var accessToken = credential.accessToken;\r\n\r\n    // ...\r\n  })\r\n  .catch((error) => {\r\n    var errorCode = error.code;\r\n    var errorMessage = error.message;\r\n    var email = error.email;\r\n    var credential = error.credential;\r\n\r\n    // ...\r\n  });\r\n  \r\n  }\r\n\r\n  const handleSignOut= () => {\r\n    firebase.auth().signOut()\r\n    .then (res=> {\r\n      const signedOutUser={\r\n        isSignedIn:false,\r\n        name:\"\",\r\n        photo: \"\" ,\r\n        email: \"\",\r\n      }\r\n      setUser(signedOutUser);\r\n    })\r\n    .catch(err=>{\r\n\r\n    })\r\n  }\r\n  const handleChange =(e) =>{\r\n    \r\n   let isFormValid=true;\r\n    if (e.target.name==='email'){\r\n      isFormValid = /\\S+@\\S+\\.\\S+/.test(e.target.value);\r\n      \r\n    }\r\n    if(e.target.name ==='password'){\r\n      const isPasswordValid = e.target.value.length > 6 ;\r\n      const passwordHasNumber=/\\d{1}/.test(e.target.value);\r\n      isFormValid= isPasswordValid && passwordHasNumber;\r\n      \r\n    }\r\n    if(isFormValid){\r\n      const newUserInfo={...user};\r\n      newUserInfo[e.target.name] = e.target.value;\r\n      setUser(newUserInfo);\r\n    }\r\n  }\r\n  const handleSubmit=(e)=>{\r\n    if(newUser && user.email && user.password){\r\n      firebase.auth().createUserWithEmailAndPassword(user.email, user.password)\r\n  .then(res => {\r\n    const newUserInfo ={...user};\r\n    newUserInfo.error = '';\r\n    newUserInfo.success=true;\r\n    setUser(newUserInfo);\r\n    updateUserName(user.name);\r\n    // ...\r\n  })\r\n  .catch((error) => {\r\n    const newUserInfo ={...user};\r\n    newUserInfo.error = error.message;\r\n    newUserInfo.success=false;\r\n    setUser(newUserInfo);\r\n    // ..\r\n  });\r\n\r\n    }\r\n    if(!newUser && user.email && user.password){\r\n      firebase.auth().signInWithEmailAndPassword(user.email, user.password)\r\n  .then(res => {\r\n    const newUserInfo ={...user};\r\n    newUserInfo.error = '';\r\n    newUserInfo.success=true;\r\n    setUser(newUserInfo);\r\n    setLoggedInUser(newUserInfo);\r\n    history.replace(from);\r\n    console.log(\"sign in info\" , user.res);\r\n    // ...\r\n  })\r\n  .catch(function(error) {\r\n    const newUserInfo ={...user};\r\n    newUserInfo.error = error.message;\r\n    newUserInfo.success=false;\r\n    setUser(newUserInfo);\r\n  });\r\n    }\r\n\r\n    e.preventDefault();\r\n  }\r\n  const updateUserName = name =>{\r\n    const user = firebase.auth().currentUser;\r\n\r\nuser.updateProfile({\r\n  displayName: name\r\n  \r\n}).then(() => {\r\n  // Update successful\r\n  console.log('update user name successfully');\r\n}).catch((error) => {\r\n  // An error occurred\r\n  console.log(error);\r\n});  \r\n  }\r\n  return (\r\n    <div className=\"App\">\r\n      \r\n    {\r\n      user.isSignedIn?<button onBlur={handleSignOut}>Sign out</button>:\r\n      <button onBlur={handleSignIn}>Sign in</button>\r\n    }\r\n    <br />\r\n    <button onClick={handlefbSignIn}> Sign in using Facebook</button>\r\n    {\r\n      user.isSignedIn && <div>\r\n        <p>Welcome, {user.name}</p>\r\n        <p>Your email: {user.email}</p>\r\n        <img src={user.photo} alt=\"\" />\r\n      </div>\r\n    }\r\n    <h1> Our own authentication</h1>\r\n    <input type=\"checkbox\" onChange={()=> setNewUser(!newUser)} name=\"newUser\" />\r\n    <label htmlFor=\"newUser\" >New user sign up</label>\r\n    \r\n    <p style={{color:'red'}}> {user.error}</p>\r\n    {user.success && <p style={{color:'green'}}> user {newUser? 'created' : 'Logged In'} successfully</p>}\r\n\r\n    <form action=\"\"  onSubmit={handleSubmit} >\r\n\r\n      {newUser && <input type=\"text\" onBlur={handleChange} name=\"name\" placeholder='Write your name' />}\r\n        <br />\r\n      <input type=\"text\" onBlur={handleChange} name=\"email\" placeholder='Write your email' required />\r\n      <br />\r\n      <input type=\"password\" onBlur={handleChange} name=\"password\" placeholder='Password' required />\r\n      <br />\r\n      <input type=\"submit\" value={newUser? 'Sign up' : 'Sign In'} />\r\n    </form>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Login;"]},"metadata":{},"sourceType":"module"}