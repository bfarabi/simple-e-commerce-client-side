{"ast":null,"code":"var _jsxFileName = \"G:\\\\Simple React MS-7\\\\ema-john- re\\\\src\\\\Components\\\\Login\\\\Login.js\",\n    _s = $RefreshSig$();\n\nimport { useContext, useState } from \"react\";\nimport { userContext } from './../../App';\nimport { useNavigate, useLocation } from \"react-router-dom\";\nimport { initializeLoginFrame } from './LoginManager';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction Login() {\n  _s();\n\n  var _location$state, _location$state$from;\n\n  initializeLoginFrame();\n  const navigate = useNavigate();\n  const location = useLocation();\n  let from = ((_location$state = location.state) === null || _location$state === void 0 ? void 0 : (_location$state$from = _location$state.from) === null || _location$state$from === void 0 ? void 0 : _location$state$from.pathname) || \"/shipment\";\n  const [loggedInUser, setLoggedInUser] = useContext(userContext);\n  const auth = getAuth();\n  const provider = new GoogleAuthProvider();\n  const [newUser, setNewUser] = useState(false);\n  const [user, setUser] = useState({\n    isSignedIn: false,\n    photo: \"\",\n    name: \"\",\n    email: \"\",\n    password: \"\",\n    error: \"\",\n    success: false\n  });\n\n  const handleSignIn = () => {\n    const auth = getAuth();\n    signInWithPopup(auth, provider).then(res => {\n      const {\n        displayName,\n        email,\n        photoURl\n      } = res.user;\n      const signedInUser = {\n        isSignedIn: true,\n        photo: photoURl,\n        name: displayName,\n        email: email\n      };\n      setUser(signedInUser);\n    }).catch(error => {\n      const errorCode = error.code;\n      console.log(errorCode);\n      const errorMessage = error.message;\n      console.log(errorMessage);\n      const email = error.email;\n    });\n  };\n\n  const handleSignOut = () => {\n    const auth = getAuth();\n    signOut(auth).then(() => {\n      const signOutUser = {\n        isSignedIn: false,\n        photo: \"\",\n        name: \"\",\n        email: \"\"\n      };\n      setUser(signOutUser);\n    }).catch(error => {});\n  };\n\n  const handleSubmit = e => {\n    if (newUser && user.email && user.password) {\n      createUserWithEmailAndPassword(auth, user.email, user.password).then(userCredential => {\n        const newUserInfo = { ...user\n        };\n        newUserInfo.error = \"\";\n        newUserInfo.success = true;\n        setUser(newUserInfo);\n        updateUserName(user.name);\n      }).catch(error => {\n        const newUserInfo = { ...user\n        };\n        newUserInfo.error = \"Email already used\";\n        newUserInfo.success = false;\n        setUser(newUserInfo);\n      });\n    }\n\n    if (!newUser && user.email && user.password) {\n      signInWithEmailAndPassword(auth, user.email, user.password).then(res => {\n        const newUserInfo = { ...user\n        };\n        newUserInfo.error = \"\";\n        newUserInfo.success = true;\n        setUser(newUserInfo);\n        setLoggedInUser(newUserInfo);\n        navigate(from, {\n          replace: true\n        });\n      }).catch(error => {\n        const newUserInfo = { ...user\n        };\n        newUserInfo.error = \"Email already used\";\n        newUserInfo.success = false;\n        setUser(newUserInfo);\n      });\n    }\n\n    e.preventDefault();\n  };\n\n  const handleChange = e => {\n    let isFormValid = true;\n\n    if (e.target.name === \"email\") {\n      const isEmailValid = /\\S+@\\S+\\.\\S+/.test(e.target.value);\n      isFormValid = isEmailValid;\n    }\n\n    if (e.target.name === \"password\") {\n      const isPasswordValid = e.target.value.length > 6 && e.target.value.length < 32;\n      const passwordHasNumber = /\\d{1}/.test(e.target.value);\n      isFormValid = isPasswordValid && passwordHasNumber;\n    }\n\n    if (isFormValid) {\n      const newUserInfo = { ...user\n      };\n      newUserInfo[e.target.name] = e.target.value;\n      setUser(newUserInfo);\n    }\n  };\n\n  const updateUserName = name => {\n    updateProfile(auth.currentUser, {\n      displayName: name\n    }).then(() => {\n      console.log(\"name update successfully\");\n    }).catch(error => {\n      console.log(error);\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      textAlign: 'center'\n    },\n    children: [user.isSignedIn ? /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: handleSignOut,\n      children: \"Sign out\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"button\", {\n      style: {\n        background: \"#2da44e\",\n        color: \"#ffffff\"\n      },\n      onClick: handleSignIn,\n      children: \"Sign in with google\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 9\n    }, this), user.isSignedIn && /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: [\"Welcome \", user.name, \" \"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\" Your email: \", user.email, \" \"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 146,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"Our own authentication\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"checkbox\",\n      onChange: () => setNewUser(!newUser),\n      name: \"newUser\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n      htmlFor: \"newUser\",\n      children: \"New user sign up\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      action: \"\",\n      onSubmit: handleSubmit,\n      children: [newUser && /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        name: \"name\",\n        placeholder: \"Your Name\",\n        onBlur: handleChange\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 158,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"email\",\n        name: \"email\",\n        id: \"input-email\",\n        placeholder: \"Enter your email address\",\n        onBlur: handleChange,\n        required: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 166,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 175,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"password\",\n        name: \"password\",\n        id: \"password\",\n        placeholder: \"Enter your password\",\n        onBlur: handleChange,\n        required: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 176,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 184,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        style: {\n          background: \"#2da44e\",\n          color: \"#ffffff\"\n        },\n        type: \"submit\",\n        value: newUser ? \"Sign up\" : \"Sign in\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 185,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 7\n    }, this), user.success && /*#__PURE__*/_jsxDEV(\"p\", {\n      style: {\n        color: \"green\"\n      },\n      children: [\"User account \", newUser ? \"created\" : \"logged in\", \" successfully\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 9\n    }, this), user.error && /*#__PURE__*/_jsxDEV(\"p\", {\n      style: {\n        color: \"red\"\n      },\n      children: user.error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 22\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 132,\n    columnNumber: 5\n  }, this);\n}\n\n_s(Login, \"/TlpZiZyK505drllpa0sLgPGFuM=\", false, function () {\n  return [useNavigate, useLocation];\n});\n\n_c = Login;\nexport default Login;\n\nvar _c;\n\n$RefreshReg$(_c, \"Login\");","map":{"version":3,"sources":["G:/Simple React MS-7/ema-john- re/src/Components/Login/Login.js"],"names":["useContext","useState","userContext","useNavigate","useLocation","initializeLoginFrame","Login","navigate","location","from","state","pathname","loggedInUser","setLoggedInUser","auth","getAuth","provider","GoogleAuthProvider","newUser","setNewUser","user","setUser","isSignedIn","photo","name","email","password","error","success","handleSignIn","signInWithPopup","then","res","displayName","photoURl","signedInUser","catch","errorCode","code","console","log","errorMessage","message","handleSignOut","signOut","signOutUser","handleSubmit","e","createUserWithEmailAndPassword","userCredential","newUserInfo","updateUserName","signInWithEmailAndPassword","replace","preventDefault","handleChange","isFormValid","target","isEmailValid","test","value","isPasswordValid","length","passwordHasNumber","updateProfile","currentUser","textAlign","background","color"],"mappings":";;;AACA,SAASA,UAAT,EAAqBC,QAArB,QAAqC,OAArC;AACA,SAASC,WAAT,QAA4B,aAA5B;AACA,SAASC,WAAT,EAAuBC,WAAvB,QAAyC,kBAAzC;AACA,SAASC,oBAAT,QAAqC,gBAArC;;;AAIA,SAASC,KAAT,GAAiB;AAAA;;AAAA;;AACbD,EAAAA,oBAAoB;AACtB,QAAME,QAAQ,GAAGJ,WAAW,EAA5B;AACA,QAAMK,QAAQ,GAAGJ,WAAW,EAA5B;AACA,MAAIK,IAAI,GAAG,oBAAAD,QAAQ,CAACE,KAAT,4FAAgBD,IAAhB,8EAAsBE,QAAtB,KAAkC,WAA7C;AAEA,QAAM,CAACC,YAAD,EAAeC,eAAf,IAAkCb,UAAU,CAACE,WAAD,CAAlD;AACA,QAAMY,IAAI,GAAGC,OAAO,EAApB;AACA,QAAMC,QAAQ,GAAG,IAAIC,kBAAJ,EAAjB;AACA,QAAM,CAACC,OAAD,EAAUC,UAAV,IAAwBlB,QAAQ,CAAC,KAAD,CAAtC;AACA,QAAM,CAACmB,IAAD,EAAOC,OAAP,IAAkBpB,QAAQ,CAAC;AAC/BqB,IAAAA,UAAU,EAAE,KADmB;AAE/BC,IAAAA,KAAK,EAAE,EAFwB;AAG/BC,IAAAA,IAAI,EAAE,EAHyB;AAI/BC,IAAAA,KAAK,EAAE,EAJwB;AAK/BC,IAAAA,QAAQ,EAAE,EALqB;AAM/BC,IAAAA,KAAK,EAAE,EANwB;AAO/BC,IAAAA,OAAO,EAAE;AAPsB,GAAD,CAAhC;;AAUA,QAAMC,YAAY,GAAG,MAAM;AACzB,UAAMf,IAAI,GAAGC,OAAO,EAApB;AACAe,IAAAA,eAAe,CAAChB,IAAD,EAAOE,QAAP,CAAf,CACGe,IADH,CACSC,GAAD,IAAS;AACb,YAAM;AAAEC,QAAAA,WAAF;AAAeR,QAAAA,KAAf;AAAsBS,QAAAA;AAAtB,UAAmCF,GAAG,CAACZ,IAA7C;AACA,YAAMe,YAAY,GAAG;AACnBb,QAAAA,UAAU,EAAE,IADO;AAEnBC,QAAAA,KAAK,EAAEW,QAFY;AAGnBV,QAAAA,IAAI,EAAES,WAHa;AAInBR,QAAAA,KAAK,EAAEA;AAJY,OAArB;AAMAJ,MAAAA,OAAO,CAACc,YAAD,CAAP;AACD,KAVH,EAWGC,KAXH,CAWUT,KAAD,IAAW;AAChB,YAAMU,SAAS,GAAGV,KAAK,CAACW,IAAxB;AACAC,MAAAA,OAAO,CAACC,GAAR,CAAYH,SAAZ;AACA,YAAMI,YAAY,GAAGd,KAAK,CAACe,OAA3B;AACAH,MAAAA,OAAO,CAACC,GAAR,CAAYC,YAAZ;AACA,YAAMhB,KAAK,GAAGE,KAAK,CAACF,KAApB;AACD,KAjBH;AAkBD,GApBD;;AAqBA,QAAMkB,aAAa,GAAG,MAAM;AAC1B,UAAM7B,IAAI,GAAGC,OAAO,EAApB;AACA6B,IAAAA,OAAO,CAAC9B,IAAD,CAAP,CACGiB,IADH,CACQ,MAAM;AACV,YAAMc,WAAW,GAAG;AAClBvB,QAAAA,UAAU,EAAE,KADM;AAElBC,QAAAA,KAAK,EAAE,EAFW;AAGlBC,QAAAA,IAAI,EAAE,EAHY;AAIlBC,QAAAA,KAAK,EAAE;AAJW,OAApB;AAMAJ,MAAAA,OAAO,CAACwB,WAAD,CAAP;AACD,KATH,EAUGT,KAVH,CAUUT,KAAD,IAAW,CAAE,CAVtB;AAWD,GAbD;;AAcA,QAAMmB,YAAY,GAAIC,CAAD,IAAO;AAC1B,QAAI7B,OAAO,IAAIE,IAAI,CAACK,KAAhB,IAAyBL,IAAI,CAACM,QAAlC,EAA4C;AAC1CsB,MAAAA,8BAA8B,CAAClC,IAAD,EAAOM,IAAI,CAACK,KAAZ,EAAmBL,IAAI,CAACM,QAAxB,CAA9B,CACGK,IADH,CACSkB,cAAD,IAAoB;AACxB,cAAMC,WAAW,GAAG,EAAE,GAAG9B;AAAL,SAApB;AACA8B,QAAAA,WAAW,CAACvB,KAAZ,GAAoB,EAApB;AACAuB,QAAAA,WAAW,CAACtB,OAAZ,GAAsB,IAAtB;AACAP,QAAAA,OAAO,CAAC6B,WAAD,CAAP;AACAC,QAAAA,cAAc,CAAC/B,IAAI,CAACI,IAAN,CAAd;AACD,OAPH,EAQGY,KARH,CAQUT,KAAD,IAAW;AAChB,cAAMuB,WAAW,GAAG,EAAE,GAAG9B;AAAL,SAApB;AACA8B,QAAAA,WAAW,CAACvB,KAAZ,GAAoB,oBAApB;AACAuB,QAAAA,WAAW,CAACtB,OAAZ,GAAsB,KAAtB;AACAP,QAAAA,OAAO,CAAC6B,WAAD,CAAP;AACD,OAbH;AAcD;;AACD,QAAI,CAAChC,OAAD,IAAYE,IAAI,CAACK,KAAjB,IAA0BL,IAAI,CAACM,QAAnC,EAA6C;AAC3C0B,MAAAA,0BAA0B,CAACtC,IAAD,EAAOM,IAAI,CAACK,KAAZ,EAAmBL,IAAI,CAACM,QAAxB,CAA1B,CACGK,IADH,CACSC,GAAD,IAAS;AACb,cAAMkB,WAAW,GAAG,EAAE,GAAG9B;AAAL,SAApB;AACA8B,QAAAA,WAAW,CAACvB,KAAZ,GAAoB,EAApB;AACAuB,QAAAA,WAAW,CAACtB,OAAZ,GAAsB,IAAtB;AACAP,QAAAA,OAAO,CAAC6B,WAAD,CAAP;AACArC,QAAAA,eAAe,CAACqC,WAAD,CAAf;AACA3C,QAAAA,QAAQ,CAACE,IAAD,EAAO;AAAE4C,UAAAA,OAAO,EAAE;AAAX,SAAP,CAAR;AACD,OARH,EASGjB,KATH,CASUT,KAAD,IAAW;AAChB,cAAMuB,WAAW,GAAG,EAAE,GAAG9B;AAAL,SAApB;AACA8B,QAAAA,WAAW,CAACvB,KAAZ,GAAoB,oBAApB;AACAuB,QAAAA,WAAW,CAACtB,OAAZ,GAAsB,KAAtB;AACAP,QAAAA,OAAO,CAAC6B,WAAD,CAAP;AACD,OAdH;AAeD;;AAEDH,IAAAA,CAAC,CAACO,cAAF;AACD,GApCD;;AAqCA,QAAMC,YAAY,GAAIR,CAAD,IAAO;AAC1B,QAAIS,WAAW,GAAG,IAAlB;;AACA,QAAIT,CAAC,CAACU,MAAF,CAASjC,IAAT,KAAkB,OAAtB,EAA+B;AAC7B,YAAMkC,YAAY,GAAG,eAAeC,IAAf,CAAoBZ,CAAC,CAACU,MAAF,CAASG,KAA7B,CAArB;AACAJ,MAAAA,WAAW,GAAGE,YAAd;AACD;;AACD,QAAIX,CAAC,CAACU,MAAF,CAASjC,IAAT,KAAkB,UAAtB,EAAkC;AAChC,YAAMqC,eAAe,GACnBd,CAAC,CAACU,MAAF,CAASG,KAAT,CAAeE,MAAf,GAAwB,CAAxB,IAA6Bf,CAAC,CAACU,MAAF,CAASG,KAAT,CAAeE,MAAf,GAAwB,EADvD;AAEA,YAAMC,iBAAiB,GAAG,QAAQJ,IAAR,CAAaZ,CAAC,CAACU,MAAF,CAASG,KAAtB,CAA1B;AACAJ,MAAAA,WAAW,GAAGK,eAAe,IAAIE,iBAAjC;AACD;;AACD,QAAIP,WAAJ,EAAiB;AACf,YAAMN,WAAW,GAAG,EAAE,GAAG9B;AAAL,OAApB;AACA8B,MAAAA,WAAW,CAACH,CAAC,CAACU,MAAF,CAASjC,IAAV,CAAX,GAA6BuB,CAAC,CAACU,MAAF,CAASG,KAAtC;AACAvC,MAAAA,OAAO,CAAC6B,WAAD,CAAP;AACD;AACF,GAjBD;;AAkBA,QAAMC,cAAc,GAAI3B,IAAD,IAAU;AAC/BwC,IAAAA,aAAa,CAAClD,IAAI,CAACmD,WAAN,EAAmB;AAC9BhC,MAAAA,WAAW,EAAET;AADiB,KAAnB,CAAb,CAGGO,IAHH,CAGQ,MAAM;AACVQ,MAAAA,OAAO,CAACC,GAAR,CAAY,0BAAZ;AACD,KALH,EAMGJ,KANH,CAMUT,KAAD,IAAW;AAChBY,MAAAA,OAAO,CAACC,GAAR,CAAYb,KAAZ;AACD,KARH;AASD,GAVD;;AAWA,sBAEE;AAAK,IAAA,KAAK,EAAE;AAACuC,MAAAA,SAAS,EAAC;AAAX,KAAZ;AAAA,eACG9C,IAAI,CAACE,UAAL,gBACC;AAAQ,MAAA,OAAO,EAAEqB,aAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YADD,gBAGC;AACE,MAAA,KAAK,EAAE;AAAEwB,QAAAA,UAAU,EAAE,SAAd;AAAyBC,QAAAA,KAAK,EAAE;AAAhC,OADT;AAEE,MAAA,OAAO,EAAEvC,YAFX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAJJ,EAWGT,IAAI,CAACE,UAAL,iBACC;AAAA,8BACE;AAAA,+BAAaF,IAAI,CAACI,IAAlB;AAAA;AAAA;AAAA;AAAA;AAAA,cADF,eAEE;AAAA,oCAAiBJ,IAAI,CAACK,KAAtB;AAAA;AAAA;AAAA;AAAA;AAAA,cAFF;AAAA;AAAA;AAAA;AAAA;AAAA,YAZJ,eAiBE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAjBF,eAkBE;AACE,MAAA,IAAI,EAAC,UADP;AAEE,MAAA,QAAQ,EAAE,MAAMN,UAAU,CAAC,CAACD,OAAF,CAF5B;AAGE,MAAA,IAAI,EAAC;AAHP;AAAA;AAAA;AAAA;AAAA,YAlBF,eAuBE;AAAO,MAAA,OAAO,EAAC,SAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAvBF,eAwBE;AAAM,MAAA,MAAM,EAAC,EAAb;AAAgB,MAAA,QAAQ,EAAE4B,YAA1B;AAAA,iBACG5B,OAAO,iBACN;AACE,QAAA,IAAI,EAAC,MADP;AAEE,QAAA,IAAI,EAAC,MAFP;AAGE,QAAA,WAAW,EAAC,WAHd;AAIE,QAAA,MAAM,EAAEqC;AAJV;AAAA;AAAA;AAAA;AAAA,cAFJ,eASE;AAAA;AAAA;AAAA;AAAA,cATF,eAUE;AACE,QAAA,IAAI,EAAC,OADP;AAEE,QAAA,IAAI,EAAC,OAFP;AAGE,QAAA,EAAE,EAAC,aAHL;AAIE,QAAA,WAAW,EAAC,0BAJd;AAKE,QAAA,MAAM,EAAEA,YALV;AAME,QAAA,QAAQ;AANV;AAAA;AAAA;AAAA;AAAA,cAVF,eAmBE;AAAA;AAAA;AAAA;AAAA,cAnBF,eAoBE;AACE,QAAA,IAAI,EAAC,UADP;AAEE,QAAA,IAAI,EAAC,UAFP;AAGE,QAAA,EAAE,EAAC,UAHL;AAIE,QAAA,WAAW,EAAC,qBAJd;AAKE,QAAA,MAAM,EAAEA,YALV;AAME,QAAA,QAAQ;AANV;AAAA;AAAA;AAAA;AAAA,cApBF,eA4BE;AAAA;AAAA;AAAA;AAAA,cA5BF,eA6BE;AACE,QAAA,KAAK,EAAE;AAAEY,UAAAA,UAAU,EAAE,SAAd;AAAyBC,UAAAA,KAAK,EAAE;AAAhC,SADT;AAEE,QAAA,IAAI,EAAC,QAFP;AAGE,QAAA,KAAK,EAAElD,OAAO,GAAG,SAAH,GAAe;AAH/B;AAAA;AAAA;AAAA;AAAA,cA7BF;AAAA;AAAA;AAAA;AAAA;AAAA,YAxBF,EA2DGE,IAAI,CAACQ,OAAL,iBACC;AAAG,MAAA,KAAK,EAAE;AAAEwC,QAAAA,KAAK,EAAE;AAAT,OAAV;AAAA,kCACgBlD,OAAO,GAAG,SAAH,GAAe,WADtC;AAAA;AAAA;AAAA;AAAA;AAAA,YA5DJ,EAgEGE,IAAI,CAACO,KAAL,iBAAc;AAAG,MAAA,KAAK,EAAE;AAAEyC,QAAAA,KAAK,EAAE;AAAT,OAAV;AAAA,gBAA6BhD,IAAI,CAACO;AAAlC;AAAA;AAAA;AAAA;AAAA,YAhEjB;AAAA;AAAA;AAAA;AAAA;AAAA,UAFF;AAqED;;GA9LQrB,K;UAEUH,W,EACAC,W;;;KAHVE,K;AAgMT,eAAeA,KAAf","sourcesContent":["\r\nimport { useContext, useState } from \"react\";\r\nimport { userContext } from './../../App';\r\nimport { useNavigate , useLocation} from \"react-router-dom\";\r\nimport { initializeLoginFrame } from './LoginManager';\r\n\r\n\r\n\r\nfunction Login() {\r\n    initializeLoginFrame();\r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n  let from = location.state?.from?.pathname || \"/shipment\";\r\n\r\n  const [loggedInUser, setLoggedInUser] = useContext(userContext);\r\n  const auth = getAuth();\r\n  const provider = new GoogleAuthProvider();\r\n  const [newUser, setNewUser] = useState(false);\r\n  const [user, setUser] = useState({\r\n    isSignedIn: false,\r\n    photo: \"\",\r\n    name: \"\",\r\n    email: \"\",\r\n    password: \"\",\r\n    error: \"\",\r\n    success: false,\r\n  });\r\n\r\n  const handleSignIn = () => {\r\n    const auth = getAuth();\r\n    signInWithPopup(auth, provider)\r\n      .then((res) => {\r\n        const { displayName, email, photoURl } = res.user;\r\n        const signedInUser = {\r\n          isSignedIn: true,\r\n          photo: photoURl,\r\n          name: displayName,\r\n          email: email,\r\n        };\r\n        setUser(signedInUser);\r\n      })\r\n      .catch((error) => {\r\n        const errorCode = error.code;\r\n        console.log(errorCode);\r\n        const errorMessage = error.message;\r\n        console.log(errorMessage);\r\n        const email = error.email;\r\n      });\r\n  };\r\n  const handleSignOut = () => {\r\n    const auth = getAuth();\r\n    signOut(auth)\r\n      .then(() => {\r\n        const signOutUser = {\r\n          isSignedIn: false,\r\n          photo: \"\",\r\n          name: \"\",\r\n          email: \"\",\r\n        };\r\n        setUser(signOutUser);\r\n      })\r\n      .catch((error) => {});\r\n  };\r\n  const handleSubmit = (e) => {\r\n    if (newUser && user.email && user.password) {\r\n      createUserWithEmailAndPassword(auth, user.email, user.password)\r\n        .then((userCredential) => {\r\n          const newUserInfo = { ...user };\r\n          newUserInfo.error = \"\";\r\n          newUserInfo.success = true;\r\n          setUser(newUserInfo);\r\n          updateUserName(user.name);\r\n        })\r\n        .catch((error) => {\r\n          const newUserInfo = { ...user };\r\n          newUserInfo.error = \"Email already used\";\r\n          newUserInfo.success = false;\r\n          setUser(newUserInfo);\r\n        });\r\n    }\r\n    if (!newUser && user.email && user.password) {\r\n      signInWithEmailAndPassword(auth, user.email, user.password)\r\n        .then((res) => {\r\n          const newUserInfo = { ...user };\r\n          newUserInfo.error = \"\";\r\n          newUserInfo.success = true;\r\n          setUser(newUserInfo);\r\n          setLoggedInUser(newUserInfo);\r\n          navigate(from, { replace: true });\r\n        })\r\n        .catch((error) => {\r\n          const newUserInfo = { ...user };\r\n          newUserInfo.error = \"Email already used\";\r\n          newUserInfo.success = false;\r\n          setUser(newUserInfo);\r\n        });\r\n    }\r\n\r\n    e.preventDefault();\r\n  };\r\n  const handleChange = (e) => {\r\n    let isFormValid = true;\r\n    if (e.target.name === \"email\") {\r\n      const isEmailValid = /\\S+@\\S+\\.\\S+/.test(e.target.value);\r\n      isFormValid = isEmailValid;\r\n    }\r\n    if (e.target.name === \"password\") {\r\n      const isPasswordValid =\r\n        e.target.value.length > 6 && e.target.value.length < 32;\r\n      const passwordHasNumber = /\\d{1}/.test(e.target.value);\r\n      isFormValid = isPasswordValid && passwordHasNumber;\r\n    }\r\n    if (isFormValid) {\r\n      const newUserInfo = { ...user };\r\n      newUserInfo[e.target.name] = e.target.value;\r\n      setUser(newUserInfo);\r\n    }\r\n  };\r\n  const updateUserName = (name) => {\r\n    updateProfile(auth.currentUser, {\r\n      displayName: name,\r\n    })\r\n      .then(() => {\r\n        console.log(\"name update successfully\");\r\n      })\r\n      .catch((error) => {\r\n        console.log(error);\r\n      });\r\n  };\r\n  return (\r\n\r\n    <div style={{textAlign:'center'}} >\r\n      {user.isSignedIn ? (\r\n        <button onClick={handleSignOut}>Sign out</button>\r\n      ) : (\r\n        <button\r\n          style={{ background: \"#2da44e\", color: \"#ffffff\" }}\r\n          onClick={handleSignIn}\r\n        >\r\n          Sign in with google\r\n        </button>\r\n      )}\r\n      {user.isSignedIn && (\r\n        <div>\r\n          <h1>Welcome {user.name} </h1>\r\n          <p> Your email: {user.email} </p>\r\n        </div>\r\n      )}\r\n      <h1>Our own authentication</h1>\r\n      <input\r\n        type=\"checkbox\"\r\n        onChange={() => setNewUser(!newUser)}\r\n        name=\"newUser\"\r\n      />\r\n      <label htmlFor=\"newUser\">New user sign up</label>\r\n      <form action=\"\" onSubmit={handleSubmit}>\r\n        {newUser && (\r\n          <input\r\n            type=\"text\"\r\n            name=\"name\"\r\n            placeholder=\"Your Name\"\r\n            onBlur={handleChange}\r\n          />\r\n        )}\r\n        <br />\r\n        <input\r\n          type=\"email\"\r\n          name=\"email\"\r\n          id=\"input-email\"\r\n          placeholder=\"Enter your email address\"\r\n          onBlur={handleChange}\r\n          required\r\n        />\r\n\r\n        <br />\r\n        <input\r\n          type=\"password\"\r\n          name=\"password\"\r\n          id=\"password\"\r\n          placeholder=\"Enter your password\"\r\n          onBlur={handleChange}\r\n          required\r\n        />\r\n        <br />\r\n        <input\r\n          style={{ background: \"#2da44e\", color: \"#ffffff\" }}\r\n          type=\"submit\"\r\n          value={newUser ? \"Sign up\" : \"Sign in\"}\r\n        />\r\n      </form>\r\n      {user.success && (\r\n        <p style={{ color: \"green\" }}>\r\n          User account {newUser ? \"created\" : \"logged in\"} successfully\r\n        </p>\r\n      )}\r\n      {user.error && <p style={{ color: \"red\" }}>{user.error}</p>}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Login;\r\n"]},"metadata":{},"sourceType":"module"}