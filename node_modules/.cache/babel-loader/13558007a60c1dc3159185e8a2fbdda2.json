{"ast":null,"code":"const getUser = () => {\n  const existingUser = sessionStorage.getItem('userId');\n\n  if (existingUser) {\n    return existingUser;\n  } else {\n    const newUser = 'user-' + new Date().getTime();\n    sessionStorage.setItem('userId', newUser);\n    return newUser;\n  }\n};\n\nconst getDataKey = () => {\n  const userId = getUser();\n  return `emaJohn/carts/${userId}`;\n}; // push to local storage: a temporary place for database\n\n\nconst getDatabaseCart = () => {\n  const dataKey = getDataKey();\n  const data = localStorage.getItem(dataKey) || \"{}\";\n  return JSON.parse(data);\n};\n\nconst addToDatabaseCart = (key, count) => {\n  const currentCart = getDatabaseCart();\n  currentCart[key] = count;\n  localStorage.setItem(getDataKey(), JSON.stringify(currentCart));\n};\n\nconst removeFromDatabaseCart = key => {\n  const currentCart = getDatabaseCart();\n  delete currentCart[key];\n  localStorage.setItem(getDataKey(), JSON.stringify(currentCart));\n};\n\nconst processOrder = cart => {\n  localStorage.removeItem(getDataKey());\n};\n\nexport { addToDatabaseCart, getDatabaseCart, removeFromDatabaseCart, processOrder }; // polyfill to support older browser\n\nconst localStorage = window.localStorage || (() => {\n  let store = {};\n  return {\n    getItem(key) {\n      return store[key];\n    },\n\n    setItem(key, value) {\n      store[key] = value.toString();\n    },\n\n    clear() {\n      store = {};\n    }\n\n  };\n})();\n\nconst sessionStorage = window.sessionStorage || (() => {\n  let store = {};\n  return {\n    getItem(key) {\n      return store[key];\n    },\n\n    setItem(key, value) {\n      store[key] = value.toString();\n    },\n\n    clear() {\n      store = {};\n    }\n\n  };\n})(); // end of poly fill","map":{"version":3,"sources":["G:/Simple React MS-7/ema-john- re/src/utilities/databaseManager.js"],"names":["getUser","existingUser","sessionStorage","getItem","newUser","Date","getTime","setItem","getDataKey","userId","getDatabaseCart","dataKey","data","localStorage","JSON","parse","addToDatabaseCart","key","count","currentCart","stringify","removeFromDatabaseCart","processOrder","cart","removeItem","window","store","value","toString","clear"],"mappings":"AAAA,MAAMA,OAAO,GAAG,MAAM;AAClB,QAAMC,YAAY,GAAGC,cAAc,CAACC,OAAf,CAAuB,QAAvB,CAArB;;AACA,MAAIF,YAAJ,EAAkB;AACd,WAAOA,YAAP;AACH,GAFD,MAEO;AACH,UAAMG,OAAO,GAAG,UAAU,IAAIC,IAAJ,GAAWC,OAAX,EAA1B;AACAJ,IAAAA,cAAc,CAACK,OAAf,CAAuB,QAAvB,EAAiCH,OAAjC;AACA,WAAOA,OAAP;AACH;AACJ,CATD;;AAYA,MAAMI,UAAU,GAAG,MAAM;AACrB,QAAMC,MAAM,GAAGT,OAAO,EAAtB;AACA,SAAQ,iBAAgBS,MAAO,EAA/B;AACH,CAHD,C,CAKA;;;AACA,MAAMC,eAAe,GAAG,MAAM;AAC1B,QAAMC,OAAO,GAAGH,UAAU,EAA1B;AACA,QAAMI,IAAI,GAAGC,YAAY,CAACV,OAAb,CAAqBQ,OAArB,KAAiC,IAA9C;AACA,SAAOG,IAAI,CAACC,KAAL,CAAWH,IAAX,CAAP;AACH,CAJD;;AAMA,MAAMI,iBAAiB,GAAG,CAACC,GAAD,EAAMC,KAAN,KAAgB;AACtC,QAAMC,WAAW,GAAGT,eAAe,EAAnC;AACAS,EAAAA,WAAW,CAACF,GAAD,CAAX,GAAmBC,KAAnB;AACAL,EAAAA,YAAY,CAACN,OAAb,CAAqBC,UAAU,EAA/B,EAAmCM,IAAI,CAACM,SAAL,CAAeD,WAAf,CAAnC;AACH,CAJD;;AAMA,MAAME,sBAAsB,GAAGJ,GAAG,IAAI;AAClC,QAAME,WAAW,GAAGT,eAAe,EAAnC;AACA,SAAOS,WAAW,CAACF,GAAD,CAAlB;AACAJ,EAAAA,YAAY,CAACN,OAAb,CAAqBC,UAAU,EAA/B,EAAmCM,IAAI,CAACM,SAAL,CAAeD,WAAf,CAAnC;AACH,CAJD;;AAMA,MAAMG,YAAY,GAAIC,IAAD,IAAU;AAC3BV,EAAAA,YAAY,CAACW,UAAb,CAAwBhB,UAAU,EAAlC;AACH,CAFD;;AAKA,SAASQ,iBAAT,EAA4BN,eAA5B,EAA6CW,sBAA7C,EAAqEC,YAArE,G,CAGA;;AACA,MAAMT,YAAY,GAAGY,MAAM,CAACZ,YAAP,IAAuB,CAAC,MAAM;AACjD,MAAIa,KAAK,GAAG,EAAZ;AACA,SAAO;AACLvB,IAAAA,OAAO,CAACc,GAAD,EAAM;AACX,aAAOS,KAAK,CAACT,GAAD,CAAZ;AACD,KAHI;;AAILV,IAAAA,OAAO,CAACU,GAAD,EAAMU,KAAN,EAAa;AAClBD,MAAAA,KAAK,CAACT,GAAD,CAAL,GAAaU,KAAK,CAACC,QAAN,EAAb;AACD,KANI;;AAOLC,IAAAA,KAAK,GAAG;AACNH,MAAAA,KAAK,GAAG,EAAR;AACD;;AATI,GAAP;AAWD,CAb2C,GAA5C;;AAeA,MAAMxB,cAAc,GAAGuB,MAAM,CAACvB,cAAP,IAAyB,CAAC,MAAM;AACrD,MAAIwB,KAAK,GAAG,EAAZ;AACA,SAAO;AACLvB,IAAAA,OAAO,CAACc,GAAD,EAAM;AACX,aAAOS,KAAK,CAACT,GAAD,CAAZ;AACD,KAHI;;AAILV,IAAAA,OAAO,CAACU,GAAD,EAAMU,KAAN,EAAa;AAClBD,MAAAA,KAAK,CAACT,GAAD,CAAL,GAAaU,KAAK,CAACC,QAAN,EAAb;AACD,KANI;;AAOLC,IAAAA,KAAK,GAAG;AACNH,MAAAA,KAAK,GAAG,EAAR;AACD;;AATI,GAAP;AAWD,CAb+C,GAAhD,C,CAcA","sourcesContent":["const getUser = () => {\n    const existingUser = sessionStorage.getItem('userId');\n    if (existingUser) {\n        return existingUser; \n    } else {\n        const newUser = 'user-' + new Date().getTime();\n        sessionStorage.setItem('userId', newUser)\n        return newUser;\n    }\n}\n\n\nconst getDataKey = () => {\n    const userId = getUser();\n    return `emaJohn/carts/${userId}`\n}\n\n// push to local storage: a temporary place for database\nconst getDatabaseCart = () => {\n    const dataKey = getDataKey();\n    const data = localStorage.getItem(dataKey) || \"{}\";\n    return JSON.parse(data);\n}\n\nconst addToDatabaseCart = (key, count) => {\n    const currentCart = getDatabaseCart();\n    currentCart[key] = count;\n    localStorage.setItem(getDataKey(), JSON.stringify(currentCart));\n}\n\nconst removeFromDatabaseCart = key => {\n    const currentCart = getDatabaseCart();\n    delete currentCart[key];\n    localStorage.setItem(getDataKey(), JSON.stringify(currentCart));\n}\n\nconst processOrder = (cart) => {\n    localStorage.removeItem(getDataKey());\n}\n\n\nexport { addToDatabaseCart, getDatabaseCart, removeFromDatabaseCart, processOrder };\n\n\n// polyfill to support older browser\nconst localStorage = window.localStorage || (() => {\n  let store = {}\n  return {\n    getItem(key) {\n      return store[key]\n    },\n    setItem(key, value) {\n      store[key] = value.toString()\n    },\n    clear() {\n      store = {}\n    }\n  };\n})()\n\nconst sessionStorage = window.sessionStorage || (() => {\n  let store = {}\n  return {\n    getItem(key) {\n      return store[key]\n    },\n    setItem(key, value) {\n      store[key] = value.toString()\n    },\n    clear() {\n      store = {}\n    }\n  };\n})()\n// end of poly fill"]},"metadata":{},"sourceType":"module"}